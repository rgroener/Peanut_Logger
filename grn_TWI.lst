   1               		.file	"grn_TWI.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               	.global	TWIInit
  12               	TWIInit:
  13               	.LFB1:
  14               		.file 1 "grn_TWI.c"
   1:grn_TWI.c     **** #include <stdio.h>
   2:grn_TWI.c     **** #include <avr/io.h>
   3:grn_TWI.c     **** 
   4:grn_TWI.c     **** 
   5:grn_TWI.c     **** /*    Grundfunktionen TWI Schnittstelle
   6:grn_TWI.c     ****  *    grn, 14.4.2015
   7:grn_TWI.c     ****  *     
   8:grn_TWI.c     ****  */
   9:grn_TWI.c     **** 
  10:grn_TWI.c     **** uint8_t TWIInit(void)
  11:grn_TWI.c     **** {
  15               		.loc 1 11 1 view -0
  16               		.cfi_startproc
  17               	/* prologue: function */
  18               	/* frame size = 0 */
  19               	/* stack size = 0 */
  20               	.L__stack_usage = 0
  12:grn_TWI.c     ****  /* initialize TWI clock: 100 kHz clock, TWPS = 0 => prescaler = 1 */
  13:grn_TWI.c     ****   PRR0 =0x00;
  21               		.loc 1 13 3 view .LVU1
  22               		.loc 1 13 8 is_stmt 0 view .LVU2
  23 0000 1092 6400 		sts 100,__zero_reg__
  14:grn_TWI.c     ****  // TWSR |= (1<<TWPS0);                          /* no prescaler */
  15:grn_TWI.c     ****  
  16:grn_TWI.c     ****   
  17:grn_TWI.c     ****   //set sck to 400khz
  18:grn_TWI.c     **** 	TWSR0 = 0x02;
  24               		.loc 1 18 2 is_stmt 1 view .LVU3
  25               		.loc 1 18 8 is_stmt 0 view .LVU4
  26 0004 82E0      		ldi r24,lo8(2)
  27 0006 8093 B900 		sts 185,r24
  19:grn_TWI.c     **** 	//TWBR = 0x0C;
  20:grn_TWI.c     **** 	 TWBR0 = ((8000000/400000)-16)/2;  /* (F_CPU / F_TWI) must be > 10 for stable operation */
  28               		.loc 1 20 3 is_stmt 1 view .LVU5
  29               		.loc 1 20 9 is_stmt 0 view .LVU6
  30 000a 8093 B800 		sts 184,r24
  21:grn_TWI.c     **** 	//enable TWI
  22:grn_TWI.c     **** 	TWCR0 = (1<<TWEN);
  31               		.loc 1 22 2 is_stmt 1 view .LVU7
  32               		.loc 1 22 8 is_stmt 0 view .LVU8
  33 000e 84E0      		ldi r24,lo8(4)
  34 0010 8093 BC00 		sts 188,r24
  23:grn_TWI.c     **** 	return 0;
  35               		.loc 1 23 2 is_stmt 1 view .LVU9
  24:grn_TWI.c     **** }
  36               		.loc 1 24 1 is_stmt 0 view .LVU10
  37 0014 80E0      		ldi r24,0
  38               	/* epilogue start */
  39 0016 0895      		ret
  40               		.cfi_endproc
  41               	.LFE1:
  43               	.global	TWIStart
  45               	TWIStart:
  46               	.LFB2:
  25:grn_TWI.c     ****  
  26:grn_TWI.c     **** uint8_t TWIStart(void)
  27:grn_TWI.c     **** {
  47               		.loc 1 27 1 is_stmt 1 view -0
  48               		.cfi_startproc
  49               	/* prologue: function */
  50               	/* frame size = 0 */
  51               	/* stack size = 0 */
  52               	.L__stack_usage = 0
  28:grn_TWI.c     **** 	TWCR0 = ((1<<TWINT) | (1<<TWSTA) | (1<<TWEN));
  53               		.loc 1 28 2 view .LVU12
  54               		.loc 1 28 8 is_stmt 0 view .LVU13
  55 0018 84EA      		ldi r24,lo8(-92)
  56 001a 8093 BC00 		sts 188,r24
  29:grn_TWI.c     **** 	while((TWCR0 & (1<<TWINT)) == 0);
  57               		.loc 1 29 2 is_stmt 1 view .LVU14
  58               	.L4:
  59               		.loc 1 29 34 discriminator 1 view .LVU15
  60               		.loc 1 29 7 discriminator 1 view .LVU16
  61               		.loc 1 29 9 is_stmt 0 discriminator 1 view .LVU17
  62 001e 8091 BC00 		lds r24,188
  63               		.loc 1 29 7 discriminator 1 view .LVU18
  64 0022 87FF      		sbrs r24,7
  65 0024 00C0      		rjmp .L4
  30:grn_TWI.c     **** 	return 0;
  66               		.loc 1 30 2 is_stmt 1 view .LVU19
  31:grn_TWI.c     **** }
  67               		.loc 1 31 1 is_stmt 0 view .LVU20
  68 0026 80E0      		ldi r24,0
  69               	/* epilogue start */
  70 0028 0895      		ret
  71               		.cfi_endproc
  72               	.LFE2:
  74               	.global	TWIStop
  76               	TWIStop:
  77               	.LFB3:
  32:grn_TWI.c     **** 
  33:grn_TWI.c     **** uint8_t TWIStop(void)
  34:grn_TWI.c     **** {
  78               		.loc 1 34 1 is_stmt 1 view -0
  79               		.cfi_startproc
  80               	/* prologue: function */
  81               	/* frame size = 0 */
  82               	/* stack size = 0 */
  83               	.L__stack_usage = 0
  35:grn_TWI.c     **** 	TWCR0 = ((1<<TWINT) | (1<<TWSTO) | (1<<TWEN));
  84               		.loc 1 35 2 view .LVU22
  85               		.loc 1 35 8 is_stmt 0 view .LVU23
  86 002a 84E9      		ldi r24,lo8(-108)
  87 002c 8093 BC00 		sts 188,r24
  36:grn_TWI.c     **** 	return 0;
  88               		.loc 1 36 2 is_stmt 1 view .LVU24
  37:grn_TWI.c     **** } 
  89               		.loc 1 37 1 is_stmt 0 view .LVU25
  90 0030 80E0      		ldi r24,0
  91               	/* epilogue start */
  92 0032 0895      		ret
  93               		.cfi_endproc
  94               	.LFE3:
  96               	.global	TWIWrite
  98               	TWIWrite:
  99               	.LVL0:
 100               	.LFB4:
  38:grn_TWI.c     **** 
  39:grn_TWI.c     **** uint8_t TWIWrite(uint8_t u8data)
  40:grn_TWI.c     **** {
 101               		.loc 1 40 1 is_stmt 1 view -0
 102               		.cfi_startproc
 103               	/* prologue: function */
 104               	/* frame size = 0 */
 105               	/* stack size = 0 */
 106               	.L__stack_usage = 0
  41:grn_TWI.c     **** 	TWDR0 = u8data;
 107               		.loc 1 41 2 view .LVU27
 108               		.loc 1 41 8 is_stmt 0 view .LVU28
 109 0034 8093 BB00 		sts 187,r24
  42:grn_TWI.c     **** 	TWCR0 = ((1<<TWINT) | (1<<TWEN));
 110               		.loc 1 42 2 is_stmt 1 view .LVU29
 111               		.loc 1 42 8 is_stmt 0 view .LVU30
 112 0038 84E8      		ldi r24,lo8(-124)
 113               	.LVL1:
 114               		.loc 1 42 8 view .LVU31
 115 003a 8093 BC00 		sts 188,r24
 116               	.LVL2:
  43:grn_TWI.c     **** 	while((TWCR0 & (1<<TWINT)) == 0);
 117               		.loc 1 43 2 is_stmt 1 view .LVU32
 118               	.L8:
 119               		.loc 1 43 34 discriminator 1 view .LVU33
 120               		.loc 1 43 7 discriminator 1 view .LVU34
 121               		.loc 1 43 9 is_stmt 0 discriminator 1 view .LVU35
 122 003e 8091 BC00 		lds r24,188
 123               		.loc 1 43 7 discriminator 1 view .LVU36
 124 0042 87FF      		sbrs r24,7
 125 0044 00C0      		rjmp .L8
  44:grn_TWI.c     **** 	return 0;
 126               		.loc 1 44 2 is_stmt 1 view .LVU37
  45:grn_TWI.c     **** }
 127               		.loc 1 45 1 is_stmt 0 view .LVU38
 128 0046 80E0      		ldi r24,0
 129               	/* epilogue start */
 130 0048 0895      		ret
 131               		.cfi_endproc
 132               	.LFE4:
 134               	.global	TWIReadACK
 136               	TWIReadACK:
 137               	.LFB5:
  46:grn_TWI.c     **** 
  47:grn_TWI.c     **** uint8_t TWIReadACK(void)
  48:grn_TWI.c     **** {
 138               		.loc 1 48 1 is_stmt 1 view -0
 139               		.cfi_startproc
 140               	/* prologue: function */
 141               	/* frame size = 0 */
 142               	/* stack size = 0 */
 143               	.L__stack_usage = 0
  49:grn_TWI.c     **** 	TWCR0 = ((1<<TWINT) | (1<<TWEN) | (1<<TWEA));
 144               		.loc 1 49 2 view .LVU40
 145               		.loc 1 49 8 is_stmt 0 view .LVU41
 146 004a 84EC      		ldi r24,lo8(-60)
 147 004c 8093 BC00 		sts 188,r24
  50:grn_TWI.c     **** 	while((TWCR0 & (1<<TWINT)) == 0);
 148               		.loc 1 50 2 is_stmt 1 view .LVU42
 149               	.L11:
 150               		.loc 1 50 34 discriminator 1 view .LVU43
 151               		.loc 1 50 7 discriminator 1 view .LVU44
 152               		.loc 1 50 9 is_stmt 0 discriminator 1 view .LVU45
 153 0050 8091 BC00 		lds r24,188
 154               		.loc 1 50 7 discriminator 1 view .LVU46
 155 0054 87FF      		sbrs r24,7
 156 0056 00C0      		rjmp .L11
  51:grn_TWI.c     **** 	return TWDR0;
 157               		.loc 1 51 2 is_stmt 1 view .LVU47
 158               		.loc 1 51 9 is_stmt 0 view .LVU48
 159 0058 8091 BB00 		lds r24,187
 160               	/* epilogue start */
  52:grn_TWI.c     **** 	return 0;
  53:grn_TWI.c     **** }
 161               		.loc 1 53 1 view .LVU49
 162 005c 0895      		ret
 163               		.cfi_endproc
 164               	.LFE5:
 166               	.global	TWIReadNACK
 168               	TWIReadNACK:
 169               	.LFB6:
  54:grn_TWI.c     **** 
  55:grn_TWI.c     **** uint8_t TWIReadNACK(void)
  56:grn_TWI.c     **** {
 170               		.loc 1 56 1 is_stmt 1 view -0
 171               		.cfi_startproc
 172               	/* prologue: function */
 173               	/* frame size = 0 */
 174               	/* stack size = 0 */
 175               	.L__stack_usage = 0
  57:grn_TWI.c     **** 	TWCR0 = ((1<<TWINT) | (1<<TWEN));
 176               		.loc 1 57 2 view .LVU51
 177               		.loc 1 57 8 is_stmt 0 view .LVU52
 178 005e 84E8      		ldi r24,lo8(-124)
 179 0060 8093 BC00 		sts 188,r24
  58:grn_TWI.c     **** 	while((TWCR0 & (1<<TWINT)) == 0);
 180               		.loc 1 58 2 is_stmt 1 view .LVU53
 181               	.L14:
 182               		.loc 1 58 34 discriminator 1 view .LVU54
 183               		.loc 1 58 7 discriminator 1 view .LVU55
 184               		.loc 1 58 9 is_stmt 0 discriminator 1 view .LVU56
 185 0064 8091 BC00 		lds r24,188
 186               		.loc 1 58 7 discriminator 1 view .LVU57
 187 0068 87FF      		sbrs r24,7
 188 006a 00C0      		rjmp .L14
  59:grn_TWI.c     **** 	return TWDR0;
 189               		.loc 1 59 2 is_stmt 1 view .LVU58
 190               		.loc 1 59 9 is_stmt 0 view .LVU59
 191 006c 8091 BB00 		lds r24,187
 192               	/* epilogue start */
  60:grn_TWI.c     **** 	return 0;
  61:grn_TWI.c     **** }
 193               		.loc 1 61 1 view .LVU60
 194 0070 0895      		ret
 195               		.cfi_endproc
 196               	.LFE6:
 198               	.global	TWIGetStatus
 200               	TWIGetStatus:
 201               	.LFB7:
  62:grn_TWI.c     **** 
  63:grn_TWI.c     **** uint8_t TWIGetStatus(void)
  64:grn_TWI.c     **** {
 202               		.loc 1 64 1 is_stmt 1 view -0
 203               		.cfi_startproc
 204               	/* prologue: function */
 205               	/* frame size = 0 */
 206               	/* stack size = 0 */
 207               	.L__stack_usage = 0
  65:grn_TWI.c     **** 	/*  0x08   Start condition sent
  66:grn_TWI.c     **** 	 *  0x10   repeated start condition sent
  67:grn_TWI.c     **** 	 *  0x18   SLA+W transmitted ACK received
  68:grn_TWI.c     **** 	 *  0x20   SLA+W transmitted NACK received
  69:grn_TWI.c     **** 	 *  0x28   data byte sent ACK received
  70:grn_TWI.c     **** 	 *  0x30   data byte sent NACK received
  71:grn_TWI.c     **** 	 *  0x38   Arbitration in SLA+W lost
  72:grn_TWI.c     **** 	 */
  73:grn_TWI.c     **** 	 
  74:grn_TWI.c     **** 	uint8_t status;
 208               		.loc 1 74 2 view .LVU62
  75:grn_TWI.c     **** 	//mask status
  76:grn_TWI.c     **** 	status = TWSR0 & 0xF8;
 209               		.loc 1 76 2 view .LVU63
 210               		.loc 1 76 17 is_stmt 0 view .LVU64
 211 0072 8091 B900 		lds r24,185
 212               	.LVL3:
  77:grn_TWI.c     **** 	return status;
 213               		.loc 1 77 2 is_stmt 1 view .LVU65
  78:grn_TWI.c     **** }
 214               		.loc 1 78 1 is_stmt 0 view .LVU66
 215 0076 887F      		andi r24,lo8(-8)
 216               	.LVL4:
 217               	/* epilogue start */
 218               		.loc 1 78 1 view .LVU67
 219 0078 0895      		ret
 220               		.cfi_endproc
 221               	.LFE7:
 223               	.Letext0:
 224               		.file 2 "/usr/avr/include/stdint.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 grn_TWI.c
     /tmp/cc1JG5zK.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/cc1JG5zK.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/cc1JG5zK.s:4      *ABS*:000000000000003f __SREG__
     /tmp/cc1JG5zK.s:5      *ABS*:0000000000000000 __tmp_reg__
     /tmp/cc1JG5zK.s:6      *ABS*:0000000000000001 __zero_reg__
     /tmp/cc1JG5zK.s:12     .text:0000000000000000 TWIInit
     /tmp/cc1JG5zK.s:45     .text:0000000000000018 TWIStart
     /tmp/cc1JG5zK.s:76     .text:000000000000002a TWIStop
     /tmp/cc1JG5zK.s:98     .text:0000000000000034 TWIWrite
     /tmp/cc1JG5zK.s:136    .text:000000000000004a TWIReadACK
     /tmp/cc1JG5zK.s:168    .text:000000000000005e TWIReadNACK
     /tmp/cc1JG5zK.s:200    .text:0000000000000072 TWIGetStatus

NO UNDEFINED SYMBOLS
