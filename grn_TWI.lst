   1               		.file	"grn_TWI.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               	.global	TWIInit
  12               	TWIInit:
  13               	.LFB1:
  14               		.file 1 "grn_TWI.c"
   1:grn_TWI.c     **** #include <stdio.h>
   2:grn_TWI.c     **** #include <avr/io.h>
   3:grn_TWI.c     **** 
   4:grn_TWI.c     **** 
   5:grn_TWI.c     **** /*    Grundfunktionen TWI Schnittstelle
   6:grn_TWI.c     ****  *    grn, 14.4.2015
   7:grn_TWI.c     ****  *     
   8:grn_TWI.c     ****  */
   9:grn_TWI.c     **** 
  10:grn_TWI.c     **** uint8_t TWIInit(void)
  11:grn_TWI.c     **** {
  15               		.loc 1 11 1 view -0
  16               		.cfi_startproc
  17               	/* prologue: function */
  18               	/* frame size = 0 */
  19               	/* stack size = 0 */
  20               	.L__stack_usage = 0
  12:grn_TWI.c     ****  /* initialize TWI clock: 100 kHz clock, TWPS = 0 => prescaler = 1 */
  13:grn_TWI.c     ****   PRR0 =0x00;
  21               		.loc 1 13 3 view .LVU1
  22               		.loc 1 13 8 is_stmt 0 view .LVU2
  23 0000 1092 6400 		sts 100,__zero_reg__
  14:grn_TWI.c     ****  // TWSR |= (1<<TWPS0);                          /* no prescaler */
  15:grn_TWI.c     ****  
  16:grn_TWI.c     ****   
  17:grn_TWI.c     ****   //set sck to 400khz
  18:grn_TWI.c     **** 	TWSR0 = 0x02;
  24               		.loc 1 18 2 is_stmt 1 view .LVU3
  25               		.loc 1 18 8 is_stmt 0 view .LVU4
  26 0004 82E0      		ldi r24,lo8(2)
  27 0006 8093 B900 		sts 185,r24
  19:grn_TWI.c     **** 	//TWBR = 0x0C;
  20:grn_TWI.c     **** 	 TWBR0 = ((16000000/400000)-16)/2;  /* (F_CPU / F_TWI) must be > 10 for stable operation */
  28               		.loc 1 20 3 is_stmt 1 view .LVU5
  29               		.loc 1 20 9 is_stmt 0 view .LVU6
  30 000a 8CE0      		ldi r24,lo8(12)
  31 000c 8093 B800 		sts 184,r24
  21:grn_TWI.c     **** 	//enable TWI
  22:grn_TWI.c     **** 	TWCR0 = (1<<TWEN);
  32               		.loc 1 22 2 is_stmt 1 view .LVU7
  33               		.loc 1 22 8 is_stmt 0 view .LVU8
  34 0010 84E0      		ldi r24,lo8(4)
  35 0012 8093 BC00 		sts 188,r24
  23:grn_TWI.c     **** 	return 0;
  36               		.loc 1 23 2 is_stmt 1 view .LVU9
  24:grn_TWI.c     **** }
  37               		.loc 1 24 1 is_stmt 0 view .LVU10
  38 0016 80E0      		ldi r24,0
  39               	/* epilogue start */
  40 0018 0895      		ret
  41               		.cfi_endproc
  42               	.LFE1:
  44               	.global	TWIStart
  46               	TWIStart:
  47               	.LFB2:
  25:grn_TWI.c     ****  
  26:grn_TWI.c     **** uint8_t TWIStart(void)
  27:grn_TWI.c     **** {
  48               		.loc 1 27 1 is_stmt 1 view -0
  49               		.cfi_startproc
  50               	/* prologue: function */
  51               	/* frame size = 0 */
  52               	/* stack size = 0 */
  53               	.L__stack_usage = 0
  28:grn_TWI.c     **** 	TWCR0 = ((1<<TWINT) | (1<<TWSTA) | (1<<TWEN));
  54               		.loc 1 28 2 view .LVU12
  55               		.loc 1 28 8 is_stmt 0 view .LVU13
  56 001a 84EA      		ldi r24,lo8(-92)
  57 001c 8093 BC00 		sts 188,r24
  29:grn_TWI.c     **** 	while((TWCR0 & (1<<TWINT)) == 0);
  58               		.loc 1 29 2 is_stmt 1 view .LVU14
  59               	.L4:
  60               		.loc 1 29 34 discriminator 1 view .LVU15
  61               		.loc 1 29 7 discriminator 1 view .LVU16
  62               		.loc 1 29 9 is_stmt 0 discriminator 1 view .LVU17
  63 0020 8091 BC00 		lds r24,188
  64               		.loc 1 29 7 discriminator 1 view .LVU18
  65 0024 87FF      		sbrs r24,7
  66 0026 00C0      		rjmp .L4
  30:grn_TWI.c     **** 	return 0;
  67               		.loc 1 30 2 is_stmt 1 view .LVU19
  31:grn_TWI.c     **** }
  68               		.loc 1 31 1 is_stmt 0 view .LVU20
  69 0028 80E0      		ldi r24,0
  70               	/* epilogue start */
  71 002a 0895      		ret
  72               		.cfi_endproc
  73               	.LFE2:
  75               	.global	TWIStop
  77               	TWIStop:
  78               	.LFB3:
  32:grn_TWI.c     **** 
  33:grn_TWI.c     **** uint8_t TWIStop(void)
  34:grn_TWI.c     **** {
  79               		.loc 1 34 1 is_stmt 1 view -0
  80               		.cfi_startproc
  81               	/* prologue: function */
  82               	/* frame size = 0 */
  83               	/* stack size = 0 */
  84               	.L__stack_usage = 0
  35:grn_TWI.c     **** 	TWCR0 = ((1<<TWINT) | (1<<TWSTO) | (1<<TWEN));
  85               		.loc 1 35 2 view .LVU22
  86               		.loc 1 35 8 is_stmt 0 view .LVU23
  87 002c 84E9      		ldi r24,lo8(-108)
  88 002e 8093 BC00 		sts 188,r24
  36:grn_TWI.c     **** 	return 0;
  89               		.loc 1 36 2 is_stmt 1 view .LVU24
  37:grn_TWI.c     **** } 
  90               		.loc 1 37 1 is_stmt 0 view .LVU25
  91 0032 80E0      		ldi r24,0
  92               	/* epilogue start */
  93 0034 0895      		ret
  94               		.cfi_endproc
  95               	.LFE3:
  97               	.global	TWIWrite
  99               	TWIWrite:
 100               	.LVL0:
 101               	.LFB4:
  38:grn_TWI.c     **** 
  39:grn_TWI.c     **** uint8_t TWIWrite(uint8_t u8data)
  40:grn_TWI.c     **** {
 102               		.loc 1 40 1 is_stmt 1 view -0
 103               		.cfi_startproc
 104               	/* prologue: function */
 105               	/* frame size = 0 */
 106               	/* stack size = 0 */
 107               	.L__stack_usage = 0
  41:grn_TWI.c     **** 	TWDR0 = u8data;
 108               		.loc 1 41 2 view .LVU27
 109               		.loc 1 41 8 is_stmt 0 view .LVU28
 110 0036 8093 BB00 		sts 187,r24
  42:grn_TWI.c     **** 	TWCR0 = ((1<<TWINT) | (1<<TWEN));
 111               		.loc 1 42 2 is_stmt 1 view .LVU29
 112               		.loc 1 42 8 is_stmt 0 view .LVU30
 113 003a 84E8      		ldi r24,lo8(-124)
 114               	.LVL1:
 115               		.loc 1 42 8 view .LVU31
 116 003c 8093 BC00 		sts 188,r24
 117               	.LVL2:
  43:grn_TWI.c     **** 	while((TWCR0 & (1<<TWINT)) == 0);
 118               		.loc 1 43 2 is_stmt 1 view .LVU32
 119               	.L8:
 120               		.loc 1 43 34 discriminator 1 view .LVU33
 121               		.loc 1 43 7 discriminator 1 view .LVU34
 122               		.loc 1 43 9 is_stmt 0 discriminator 1 view .LVU35
 123 0040 8091 BC00 		lds r24,188
 124               		.loc 1 43 7 discriminator 1 view .LVU36
 125 0044 87FF      		sbrs r24,7
 126 0046 00C0      		rjmp .L8
  44:grn_TWI.c     **** 	return 0;
 127               		.loc 1 44 2 is_stmt 1 view .LVU37
  45:grn_TWI.c     **** }
 128               		.loc 1 45 1 is_stmt 0 view .LVU38
 129 0048 80E0      		ldi r24,0
 130               	/* epilogue start */
 131 004a 0895      		ret
 132               		.cfi_endproc
 133               	.LFE4:
 135               	.global	TWIReadACK
 137               	TWIReadACK:
 138               	.LFB5:
  46:grn_TWI.c     **** 
  47:grn_TWI.c     **** uint8_t TWIReadACK(void)
  48:grn_TWI.c     **** {
 139               		.loc 1 48 1 is_stmt 1 view -0
 140               		.cfi_startproc
 141               	/* prologue: function */
 142               	/* frame size = 0 */
 143               	/* stack size = 0 */
 144               	.L__stack_usage = 0
  49:grn_TWI.c     **** 	TWCR0 = ((1<<TWINT) | (1<<TWEN) | (1<<TWEA));
 145               		.loc 1 49 2 view .LVU40
 146               		.loc 1 49 8 is_stmt 0 view .LVU41
 147 004c 84EC      		ldi r24,lo8(-60)
 148 004e 8093 BC00 		sts 188,r24
  50:grn_TWI.c     **** 	while((TWCR0 & (1<<TWINT)) == 0);
 149               		.loc 1 50 2 is_stmt 1 view .LVU42
 150               	.L11:
 151               		.loc 1 50 34 discriminator 1 view .LVU43
 152               		.loc 1 50 7 discriminator 1 view .LVU44
 153               		.loc 1 50 9 is_stmt 0 discriminator 1 view .LVU45
 154 0052 8091 BC00 		lds r24,188
 155               		.loc 1 50 7 discriminator 1 view .LVU46
 156 0056 87FF      		sbrs r24,7
 157 0058 00C0      		rjmp .L11
  51:grn_TWI.c     **** 	return TWDR0;
 158               		.loc 1 51 2 is_stmt 1 view .LVU47
 159               		.loc 1 51 9 is_stmt 0 view .LVU48
 160 005a 8091 BB00 		lds r24,187
 161               	/* epilogue start */
  52:grn_TWI.c     **** 	return 0;
  53:grn_TWI.c     **** }
 162               		.loc 1 53 1 view .LVU49
 163 005e 0895      		ret
 164               		.cfi_endproc
 165               	.LFE5:
 167               	.global	TWIReadNACK
 169               	TWIReadNACK:
 170               	.LFB6:
  54:grn_TWI.c     **** 
  55:grn_TWI.c     **** uint8_t TWIReadNACK(void)
  56:grn_TWI.c     **** {
 171               		.loc 1 56 1 is_stmt 1 view -0
 172               		.cfi_startproc
 173               	/* prologue: function */
 174               	/* frame size = 0 */
 175               	/* stack size = 0 */
 176               	.L__stack_usage = 0
  57:grn_TWI.c     **** 	TWCR0 = ((1<<TWINT) | (1<<TWEN));
 177               		.loc 1 57 2 view .LVU51
 178               		.loc 1 57 8 is_stmt 0 view .LVU52
 179 0060 84E8      		ldi r24,lo8(-124)
 180 0062 8093 BC00 		sts 188,r24
  58:grn_TWI.c     **** 	while((TWCR0 & (1<<TWINT)) == 0);
 181               		.loc 1 58 2 is_stmt 1 view .LVU53
 182               	.L14:
 183               		.loc 1 58 34 discriminator 1 view .LVU54
 184               		.loc 1 58 7 discriminator 1 view .LVU55
 185               		.loc 1 58 9 is_stmt 0 discriminator 1 view .LVU56
 186 0066 8091 BC00 		lds r24,188
 187               		.loc 1 58 7 discriminator 1 view .LVU57
 188 006a 87FF      		sbrs r24,7
 189 006c 00C0      		rjmp .L14
  59:grn_TWI.c     **** 	return TWDR0;
 190               		.loc 1 59 2 is_stmt 1 view .LVU58
 191               		.loc 1 59 9 is_stmt 0 view .LVU59
 192 006e 8091 BB00 		lds r24,187
 193               	/* epilogue start */
  60:grn_TWI.c     **** 	return 0;
  61:grn_TWI.c     **** }
 194               		.loc 1 61 1 view .LVU60
 195 0072 0895      		ret
 196               		.cfi_endproc
 197               	.LFE6:
 199               	.global	TWIGetStatus
 201               	TWIGetStatus:
 202               	.LFB7:
  62:grn_TWI.c     **** 
  63:grn_TWI.c     **** uint8_t TWIGetStatus(void)
  64:grn_TWI.c     **** {
 203               		.loc 1 64 1 is_stmt 1 view -0
 204               		.cfi_startproc
 205               	/* prologue: function */
 206               	/* frame size = 0 */
 207               	/* stack size = 0 */
 208               	.L__stack_usage = 0
  65:grn_TWI.c     **** 	/*  0x08   Start condition sent
  66:grn_TWI.c     **** 	 *  0x10   repeated start condition sent
  67:grn_TWI.c     **** 	 *  0x18   SLA+W transmitted ACK received
  68:grn_TWI.c     **** 	 *  0x20   SLA+W transmitted NACK received
  69:grn_TWI.c     **** 	 *  0x28   data byte sent ACK received
  70:grn_TWI.c     **** 	 *  0x30   data byte sent NACK received
  71:grn_TWI.c     **** 	 *  0x38   Arbitration in SLA+W lost
  72:grn_TWI.c     **** 	 */
  73:grn_TWI.c     **** 	 
  74:grn_TWI.c     **** 	uint8_t status;
 209               		.loc 1 74 2 view .LVU62
  75:grn_TWI.c     **** 	//mask status
  76:grn_TWI.c     **** 	status = TWSR0 & 0xF8;
 210               		.loc 1 76 2 view .LVU63
 211               		.loc 1 76 17 is_stmt 0 view .LVU64
 212 0074 8091 B900 		lds r24,185
 213               	.LVL3:
  77:grn_TWI.c     **** 	return status;
 214               		.loc 1 77 2 is_stmt 1 view .LVU65
  78:grn_TWI.c     **** }
 215               		.loc 1 78 1 is_stmt 0 view .LVU66
 216 0078 887F      		andi r24,lo8(-8)
 217               	.LVL4:
 218               	/* epilogue start */
 219               		.loc 1 78 1 view .LVU67
 220 007a 0895      		ret
 221               		.cfi_endproc
 222               	.LFE7:
 224               	.Letext0:
 225               		.file 2 "/usr/avr/include/stdint.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 grn_TWI.c
     /tmp/ccUO3a0V.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/ccUO3a0V.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/ccUO3a0V.s:4      *ABS*:000000000000003f __SREG__
     /tmp/ccUO3a0V.s:5      *ABS*:0000000000000000 __tmp_reg__
     /tmp/ccUO3a0V.s:6      *ABS*:0000000000000001 __zero_reg__
     /tmp/ccUO3a0V.s:12     .text:0000000000000000 TWIInit
     /tmp/ccUO3a0V.s:46     .text:000000000000001a TWIStart
     /tmp/ccUO3a0V.s:77     .text:000000000000002c TWIStop
     /tmp/ccUO3a0V.s:99     .text:0000000000000036 TWIWrite
     /tmp/ccUO3a0V.s:137    .text:000000000000004c TWIReadACK
     /tmp/ccUO3a0V.s:169    .text:0000000000000060 TWIReadNACK
     /tmp/ccUO3a0V.s:201    .text:0000000000000074 TWIGetStatus

NO UNDEFINED SYMBOLS
